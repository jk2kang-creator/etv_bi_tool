<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ë¦¬ë² ì´íŠ¸ ë¶„ì„ ì‹œìŠ¤í…œ (v1.3.88)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    /* --- v1.3.84~88 UI ê·œê²© ë° ë””ìì¸ ê°€ì´ë“œ ê³ ì • --- */
    :root{
      --bg:#f5f7fb; --card:#ffffff; --text:#1f2a37; --muted:#6b7280; --border:#e5e7eb;
      --primary:#1f5eff; --primary-2:#0b4bd6; --danger:#e11d48; --success:#10b981;
      --warning:#f59e0b; --radius: 12px;
      --font: "Pretendard", -apple-system, BlinkMacSystemFont, system-ui, Roboto, "Noto Sans KR", sans-serif;
    }
    *{box-sizing:border-box}
    body{ margin:0; background:var(--bg); color:var(--text); font-family:var(--font); -webkit-font-smoothing: antialiased; overflow: hidden; }

    .app{ height:100vh; display:grid; grid-template-columns: 260px 1fr; grid-template-rows: 64px 1fr; grid-template-areas: "head head" "lnb body"; transition: 0.3s ease; }
    .app.lnb-hidden { grid-template-columns: 0px 1fr; }
    
    header{ grid-area:head; display:flex; align-items:center; justify-content:space-between; padding:0 20px; background:#0f2342; color:#fff; z-index:100; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .brand-wrap { display:flex; align-items:center; gap:12px; }
    .menu-toggle { background: transparent; border: none; color: #fff; font-size: 20px; cursor: pointer; outline: none; }
    .brand{ font-weight:800; font-size:16px; letter-spacing:-.5px; }
    .pill { background:rgba(255,255,255,0.1); padding:2px 8px; border-radius:6px; font-size:10px; border:1px solid rgba(255,255,255,0.2); margin-left:8px; }
    
    nav{ grid-area:lnb; padding:20px 15px; border-right:1px solid var(--border); background:#fff; overflow-y:auto; display:flex; flex-direction:column; gap:8px; transition: 0.3s; }
    .lnb-title { font-size:11px; color:#94a3b8; font-weight:700; margin:10px 0 8px 10px; text-transform:uppercase; letter-spacing: 0.5px; }
    .lnb-item{ display:flex; align-items:center; gap:12px; padding:10px 15px; border-radius:10px; cursor:pointer; color:#475569; transition:0.2s; text-decoration: none; font-size: 14px; }
    .lnb-item:hover { background: #f8fafc; color: var(--primary); }
    .lnb-item.active{ background:#eff6ff; color:#2563eb; font-weight:700; }
    .lnb-ico{ font-size:16px; width:20px; text-align:center; }
    .lnb-sub{ font-size:11px; color:#94a3b8; margin-top:2px; font-weight:400; }
    .lnb-divider { height:1px; background:#f1f5f9; margin:12px 0; }

    main{ grid-area:body; padding:20px; overflow-y:auto; min-width: 0; }
    
    /* ìˆ˜ì • ëª¨ë“œìš© ìŠ¤íƒ€ì¼ (ì†ìµí˜„í™© ì°¸ì¡°) */
    .edit-mode-toggle { display: flex; align-items: center; gap: 8px; height: 36px; padding: 0 12px; background: #f1f5f9; border-radius: 6px; border: 1px solid var(--border); cursor: pointer; transition: 0.2s; }
    .edit-mode-toggle span { font-size: 11px; font-weight: 600; color: #2563eb; }
    .table-input { width: 100%; border: 1px solid transparent; background: transparent; text-align: right; padding: 2px 4px; font-family: 'Courier New', monospace; font-size: 11px; font-weight: 600; color: #334155; border-radius: 4px; pointer-events: none; }
    .edit-active .table-input { pointer-events: auto; border-color: #cbd5e1; background: #ffffff; }
    .edit-active .editable-cell { background-color: #fffbeb !important; }

    .search-card { background:var(--card); border:1px solid var(--border); border-radius:var(--radius); box-shadow: 0 2px 4px rgba(0,0,0,0.02); padding:20px; margin-bottom:16px; }
    .search-hd { display:flex; justify-content:space-between; align-items:center; margin-bottom:15px; padding-bottom:10px; border-bottom:1px solid #f1f5f9; }
    .search-hd h3 { margin:0; font-size:15px; font-weight:700; color:#1e293b; }
    .top-actions { display:flex; align-items:center; gap:8px; }
    
    .search-controls { display:flex; flex-wrap:wrap; gap:12px; align-items:flex-end; }
    .field { display:flex; flex-direction:column; gap:4px; }
    .field label { font-size:11px; font-weight:600; color:var(--muted); }
    select, input { height:36px; border-radius:6px; border:1px solid var(--border); padding:0 10px; font-size:12px; outline:none; background:#fff; min-width:110px; }

    .btn{ height:36px; padding:0 12px; border-radius:6px; border:1px solid var(--border); font-weight:600; font-size:11px; cursor:pointer; display:inline-flex; align-items:center; gap:6px; transition:0.2s; justify-content: center; }
    .btn.primary{ background:var(--primary); color:#fff; border:none; }
    .btn.success { background:var(--success); color:#fff; border:none; }
    .btn.outline { background: #fff; color: var(--text); }

    .table-container{ overflow-x:auto; border:1px solid var(--border); border-radius:8px; background: #fff; margin-bottom: 16px; position: relative; }
    table{ width: 100%; min-width: max-content; border-collapse:collapse; font-size:11px; table-layout: fixed; }
    th{ position:sticky; top:0; background:#f8fafc; padding:8px; border:1px solid var(--border); text-align:center; color:#64748b; font-weight: 700; z-index: 10; }
    td{ padding:4px 8px; border:1px solid var(--border); color:#334155; }
    .center { text-align: center; }
    .right { text-align: right; }
    .bg-yellow { background-color: #fffde7 !important; font-weight: 800; }
    .sticky-col { position: sticky; left: 0; z-index: 12; width: 80px !important; background: #f1f5f9 !important; font-weight: 800; border-right: 2px solid #cbd5e1; }
    .mono { font-family: 'Courier New', monospace; font-weight: 600; }
  </style>
</head>
<body>

<div class="app" id="appContainer">
  <header>
    <div class="brand-wrap">
      <button class="menu-toggle" onclick="toggleLNB()">&#9776;</button>
      <div class="brand">ğŸ“Š ETEVERS GROUP ê²½ì˜ê´€ë¦¬ ì‹œìŠ¤í…œ <span class="pill">v1.3.88</span></div>
    </div>
    <div class="user"><strong style="font-size:12px">ë¹„ì¦ˆë‹ˆìŠ¤ê¸°íšíŒ€ ê°•í˜•êµ¬ ë‹˜</strong></div>
  </header>

  <nav>
    <div class="lnb-title">Management Services</div>
    <a href="#" class="lnb-item"><div class="lnb-ico">ğŸ“‰</div><div>ì†ìµí˜„í™©<div class="lnb-sub">ì „ì‚¬ ë¶„ì„</div></div></a>
    <a href="#" class="lnb-item"><div class="lnb-ico">ğŸ¯</div><div>ëª©í‘œí˜„í™©<div class="lnb-sub">ëª©í‘œë‹¬ì„±ìœ¨</div></div></a>
    <a href="#" class="lnb-item"><div class="lnb-ico">ğŸ’°</div><div>ë§¤ì¶œí˜„í™©<div class="lnb-sub">ì¶œí•˜ì™„ë£Œ ê¸°ì¤€</div></div></a>
    <a href="#" class="lnb-item"><div class="lnb-ico">ğŸ¦</div><div>ìš´ì „ìê¸ˆí˜„í™©<div class="lnb-sub">Cash Flow</div></div></a>
    <a href="#" class="lnb-item active"><div class="lnb-ico">ğŸ·ï¸</div><div>ë¦¬ë² ì´íŠ¸ í˜„í™©<div class="lnb-sub">Vendor Rebate</div></div></a>
    <a href="#" class="lnb-item"><div class="lnb-ico">ğŸ“¦</div><div>ì¬ê³ í˜„í™©<div class="lnb-sub">ì¬ê³  ë¶„ì„</div></div></a>
    <a href="#" class="lnb-item"><div class="lnb-ico">ğŸ§¾</div><div>ë¯¸ìˆ˜ê¸ˆí˜„í™©<div class="lnb-sub">ì±„ê¶Œ ê´€ë¦¬</div></div></a>
    <a href="#" class="lnb-item"><div class="lnb-ico">ğŸ“„</div><div>ë¯¸ë°œí–‰í˜„í™©<div class="lnb-sub">ì„¸ê¸ˆê³„ì‚°ì„œ</div></div></a>
    <a href="#" class="lnb-item"><div class="lnb-ico">â†©ï¸</div><div>ë°˜í’ˆì´ë ¥ì¡°íšŒ<div class="lnb-sub">History</div></div></a>
    <div class="lnb-divider"></div>
    <a href="#" class="lnb-item"><div class="lnb-ico">âš™ï¸</div><div>ê´€ë¦¬ì ì„¤ì •</div></a>
  </nav>

  <main id="mainContainer">
    <div class="search-card">
      <div class="search-hd">
        <h3>ë¦¬ë² ì´íŠ¸(MDF) ì§‘í–‰ í˜„í™© ê´€ë¦¬</h3>
        <div class="top-actions">
          <button class="btn outline" onclick="addMonth()">ğŸ“… ì›” ì¶”ê°€</button>
          <button class="btn outline" onclick="addRow()">â• í–‰ ì¶”ê°€</button>
          <label class="edit-mode-toggle">
            <input type="checkbox" id="editToggle" onchange="toggleEditMode()">
            <span>ìˆ˜ì • ëª¨ë“œ</span>
          </label>
          <button class="btn success" onclick="alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.')">ğŸ’¾ ì €ì¥</button>
        </div>
      </div>
      <div class="search-controls">
        <div class="field"><label>íšŒê³„ì—°ë„</label><select><option>2026ë…„</option></select></div>
        <div class="field"><label>ì¡°íšŒì›”</label><select id="monthFilter"><option>01ì›”</option></select></div>
        <button class="btn primary">ğŸ” ì¡°íšŒ</button>
      </div>
    </div>

    <div class="table-container">
      <table id="rebateTable">
        <thead>
          <tr>
            <th class="sticky-col">êµ¬ë¶„</th>
            <th style="width:100px">í”„ë¡œê·¸ë¨ëª…</th>
            <th style="width:120px">ì…ê¸ˆì•¡(A)</th>
            <th style="width:120px">ì´ì›”ê¸ˆì•¡(B)</th>
            <th style="width:120px">ì§€ê¸‰ì•¡</th>
            <th style="width:150px">ì§€ê¸‰ì—…ì²´</th>
            <th style="width:180px">ì§€ê¸‰ë‚´ìš©</th>
            <th style="width:120px">ì”ì•¡</th>
          </tr>
        </thead>
        <tbody id="rebateBody">
          <tr class="month-group-1">
            <td rowspan="2" class="sticky-col center">1ì›”</td>
            <td class="editable-cell"><input type="text" class="table-input" value="Sell-In" style="text-align:center"></td>
            <td class="editable-cell"><input type="text" class="table-input" value="1,000,000"></td>
            <td class="editable-cell"><input type="text" class="table-input" value="0"></td>
            <td class="editable-cell"><input type="text" class="table-input" value="500,000"></td>
            <td class="editable-cell"><input type="text" class="table-input" value="ì—…ì²´A" style="text-align:center"></td>
            <td class="editable-cell"><input type="text" class="table-input" value="ì •ì‚°ë‚´ìš©" style="text-align:left"></td>
            <td class="right mono">500,000</td>
          </tr>
          <tr class="month-group-1">
            <td class="editable-cell"><input type="text" class="table-input" value="Sell-Out" style="text-align:center"></td>
            <td class="editable-cell"><input type="text" class="table-input" value="0"></td>
            <td class="editable-cell"><input type="text" class="table-input" value="2,000,000"></td>
            <td class="editable-cell"><input type="text" class="table-input" value="1,500,000"></td>
            <td class="editable-cell"><input type="text" class="table-input" value="ì—…ì²´B" style="text-align:center"></td>
            <td class="editable-cell"><input type="text" class="table-input" value="í”„ë¡œëª¨ì…˜" style="text-align:left"></td>
            <td class="right mono">500,000</td>
          </tr>
        </tbody>
      </table>
    </div>
  </main>
</div>

<script>
  let currentMonthCount = 1;

  function toggleLNB() { document.getElementById('appContainer').classList.toggle('lnb-hidden'); }

  // ì†ìµí˜„í™© ë¡œì§ ì ìš©: ìˆ˜ì • ëª¨ë“œ í† ê¸€
  function toggleEditMode() {
    const isEdit = document.getElementById('editToggle').checked;
    document.getElementById('mainContainer').classList.toggle('edit-active', isEdit);
  }

  // í–‰(Row) ì¶”ê°€ ê¸°ëŠ¥: ë§ˆì§€ë§‰ ì›” ê·¸ë£¹ì— ìƒˆë¡œìš´ í–‰ ì‚½ì…
  function addRow() {
    const tbody = document.getElementById('rebateBody');
    const lastMonthGroup = `month-group-${currentMonthCount}`;
    const firstRowInGroup = tbody.querySelector(`.${lastMonthGroup}`);
    
    if (firstRowInGroup) {
      // ì²« ë²ˆì§¸ í–‰ì˜ rowspanì„ 1ì”© ì¦ê°€ì‹œí‚´
      const firstTd = firstRowInGroup.querySelector('td[rowspan]');
      const currentRS = parseInt(firstTd.getAttribute('rowspan'));
      firstTd.setAttribute('rowspan', currentRS + 1);

      // ìƒˆë¡œìš´ í–‰ ìƒì„±
      const newRow = document.createElement('tr');
      newRow.className = lastMonthGroup;
      newRow.innerHTML = `
        <td class="editable-cell"><input type="text" class="table-input" value="ì‹ ê·œ í•­ëª©" style="text-align:center"></td>
        <td class="editable-cell"><input type="text" class="table-input" value="0"></td>
        <td class="editable-cell"><input type="text" class="table-input" value="0"></td>
        <td class="editable-cell"><input type="text" class="table-input" value="0"></td>
        <td class="editable-cell"><input type="text" class="table-input" value="-" style="text-align:center"></td>
        <td class="editable-cell"><input type="text" class="table-input" value="-" style="text-align:left"></td>
        <td class="right mono">0</td>
      `;
      tbody.appendChild(newRow);
    }
  }

  // ì›”(Column/Section) ì¶”ê°€ ê¸°ëŠ¥: ìƒˆë¡œìš´ ì›” ë‹¨ìœ„ ê·¸ë£¹ ìƒì„±
  function addMonth() {
    currentMonthCount++;
    const tbody = document.getElementById('rebateBody');
    const nextMonth = `${currentMonthCount}ì›”`;
    
    const newGroupRow = document.createElement('tr');
    newGroupRow.className = `month-group-${currentMonthCount}`;
    newGroupRow.innerHTML = `
      <td rowspan="1" class="sticky-col center">${nextMonth}</td>
      <td class="editable-cell"><input type="text" class="table-input" value="í”„ë¡œê·¸ë¨" style="text-align:center"></td>
      <td class="editable-cell"><input type="text" class="table-input" value="0"></td>
      <td class="editable-cell"><input type="text" class="table-input" value="0"></td>
      <td class="editable-cell"><input type="text" class="table-input" value="0"></td>
      <td class="editable-cell"><input type="text" class="table-input" value="-" style="text-align:center"></td>
      <td class="editable-cell"><input type="text" class="table-input" value="-" style="text-align:left"></td>
      <td class="right mono">0</td>
    `;
    tbody.appendChild(newGroupRow);

    // í•„í„°ì—ë„ ì›” ì¶”ê°€
    const select = document.getElementById('monthFilter');
    const opt = document.createElement('option');
    opt.text = `${String(currentMonthCount).padStart(2, '0')}ì›”`;
    select.add(opt);
  }
</script>
</body>
</html>
